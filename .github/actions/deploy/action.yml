name: Deploy
description: Publish the new versions on NPM and re deploy the website
runs:
    using: 'composite'
    steps:
        - name: Publish new version
          shell: bash
          run: node build/publishNewVersion.mjs
        - name: Get new version
          id: get-version
          shell: bash
          run: echo "version=$(node build/getLastTag.mjs)" >> $GITHUB_OUTPUT
        - name: Create & Deploy master package
          shell: bash
          run: deployment-package package create --version ${{ steps.get-version.outputs.version }} --resolve VERSION=${{ steps.get-version.outputs.version }} --with-deploy
